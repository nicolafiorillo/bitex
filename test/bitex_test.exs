defmodule BitexTest do
  use ExUnit.Case
  doctest Bitex

  test "serialize 1" do
      n8 = 0x01
      n16 = 0x4523
      n32 = 0xcdab8967
      n64 = 0xdebc9a78563412ef

      a = [n8, n16, n32, n64]
      assert Bitex.Kernel.serialize(a) == [0x01,
                                            0x23, 0x45,
                                            0x67, 0x89, 0xAB, 0xCD,
                                            0xEF, 0x12, 0x34, 0x56, 0x78, 0x9A, 0xBC, 0xDE]
  end

  test "serialize 2" do
      n32 = 0x68f7a38b
      str = {10, "FooBar"}
      n16 = 0xee12

      a = [n32, str, n16]
      assert Bitex.Kernel.serialize(a) == [0x8B, 0xA3, 0xF7, 0x68,
                                            0x46, 0x6F, 0x6F, 0x42, 0x61, 0x72, 0x00, 0x00, 0x00, 0x00,
                                            0x12, 0xEE]
  end

  test "serialize 3" do
      message = "Hello Bitcoin!"
      prefix = 0xd17f
      suffix = 0x8c

      a = [prefix, Bitex.Kernel.hash256(message), suffix]
      assert Bitex.Kernel.serialize(a) == [0x7F, 0xD1,
                                            0x90, 0x98, 0x6E, 0xA4, 0xE2, 0x8B, 0x84, 0x7C,
                                            0xC7, 0xF9, 0xBE, 0xBA, 0x87, 0xEA, 0x81, 0xB2,
                                            0x21, 0xCA, 0x6E, 0xAF, 0x98, 0x28, 0xA8, 0xB0,
                                            0x4C, 0x29, 0x0C, 0x21, 0xD8, 0x91, 0xBC, 0xDA,
                                            0x8C]
  end
end
